avp_radius Module

Juha Heinanen

   <jh@tutpro.com>

Edited by

Daniel-Constantin Mierla

   <miconda@gmail.com>

   Copyright © 2004-2008 Juha Heinanen
     __________________________________________________________

   Table of Contents

   1. Admin Guide

        1.1. Overview
        1.2. Dependencies

              1.2.1. Kamailio Modules
              1.2.2. External Libraries or Applications

        1.3. Exported Parameters

              1.3.1. radius_config (string)
              1.3.2. caller_service_type (integer)
              1.3.3. callee_service_type (integer)
              1.3.4. caller_extra (string)
              1.3.5. callee_extra (string)

        1.4. Exported Functions

              1.4.1. radius_load_caller_avps(caller)
              1.4.2. radius_load_callee_avps(callee)

   List of Examples

   1.1. "SIP-AVP" RADIUS AVP exmaples
   1.2. radius_config parameter usage
   1.3. caller_service_type parameter usage
   1.4. callee_service_type parameter usage
   1.5. caller_extra parameter usage
   1.6. callee_extra parameter usage
   1.7. radius_load_caller_avps() usage
   1.8. radius_load_callee_avps() usage

Chapter 1. Admin Guide

1.1. Overview

   avp_radius module allows loading of user's attributes into AVPs
   from Radius. User's name is given in a pseudo variable to load
   functions.

   The module assumes that Radius returns the AVPs as values of
   reply attribute SIP-AVP. Its value must be a string of form:
     * value = SIP_AVP_NAME SIP_AVP_VALUE
     * SIP_AVP_NAME = STRING_NAME | '#'ID_NUMBER
     * SIP_AVP_VALUE = ':'STRING_VALUE | '#'NUMBER_VALUE

   Example 1.1. "SIP-AVP" RADIUS AVP exmaples
....
"email:joe@yahoo.com"
    -> STRING NAME AVP (email) with STRING VALUE (joe@yahoo.com)
"#14:joe@yahoo.com"
    -> ID AVP (14) with STRING VALUE (joe@yahoo.com)
"age#28"
    -> STRING NAME AVP (age) with INTEGER VALUE (28)
"#14#28"
    -> ID AVP (14) with INTEGER VALUE (28)
....

   Unlike earlier version of this module, load functions don't
   prefix AVPs that have STRING NAME by by string "caller_" or
   "callee_" depending if caller's or callee's attributes are
   loaded. If you need these prefixes, make your Radius server to
   prepend them into attribute names when constructing reply
   items.

1.2. Dependencies

1.2.1. Kamailio Modules

   The module depends on the following modules (in the other words
   the listed modules must be loaded before this module):
     * none

1.2.2. External Libraries or Applications

   The following libraries or applications must be installed
   before compilling Kamailio with this module loaded:
     * radiusclient-ng 0.5.0 or higher -- library and development
       files. See
       http://developer.berlios.de/projects/radiusclient-ng/.

1.3. Exported Parameters

1.3.1. radius_config (string)

   This is the location of the configuration file of radius client
   libraries.

   Default value is
   "/usr/local/etc/radiusclient-ng/radiusclient.conf".

   Example 1.2. radius_config parameter usage
...
modparam("avp_radius", "radius_config", "/etc/radiusclient.conf")

1.3.2. caller_service_type (integer)

   This is the value of the Service-Type radius attribute to be
   used, when caller's attributes are loaded.

   Default value is dictionary value of "SIP-Caller-AVPs"
   Service-Type.

   Example 1.3. caller_service_type parameter usage
...
modparam("avp_radius", "caller_service_type", 18)

1.3.3. callee_service_type (integer)

   This is the value of the Service-Type radius attribute to be
   used, when callee's attributes are loaded.

   Default value is dictionary value of "SIP-Callee-AVPs"
   Service-Type.

   Example 1.4. callee_service_type parameter usage
...
modparam("avp_radius", "callee_service_type", 19)

1.3.4. caller_extra (string)

   Semi-colon separated list of extra Radius attribute name=pseudo
   variable pairs. When radius_load_caller_avps() is called, the
   listed extra attributes are included Radius request with
   current values of corresponding pseudo variables.

   There is no default value, i.e., by default no extra attributes
   are included.

   Example 1.5. caller_extra parameter usage
...
modparam("avp_radius", "caller_extra", "Calling-Station-Id=$fu")

1.3.5. callee_extra (string)

   Semi-colon separated list of extra Radius attribute name=pseudo
   variable pairs. When radius_load_callee_avps() is called, the
   listed extra attributes are included Radius request with
   current values of corresponding pseudo variables.

   There is no default value, i.e., by default no extra attributes
   are included.

   Example 1.6. callee_extra parameter usage
...
modparam("avp_radius", "callee_extra", "SIP-URI-User=$rU;SIP-URI-Host=$r
d")

1.4. Exported Functions

1.4.1. radius_load_caller_avps(caller)

   The functions loads caller's attributes from radius and stores
   them into AVPs. Parameter "caller" is a string that may contain
   pseudo variables. It indicates the user, whose attributes are
   loaded.

   This function can be used from REQUEST_ROUTE, FAILURE_ROUTE.

   Example 1.7. radius_load_caller_avps() usage
...
radius_load_caller_avps("$fU@$fd");     # take caller from From URI
...
radius_load_caller_avps("$au@$ar");     # take caller from Authorization
...                                     # or Proxy-Authorization header

1.4.2. radius_load_callee_avps(callee)

   The functions loads callee's attributes from radius and stores
   them into AVPs. Parameter "callee" is a string that may contain
   pseudo variables. It indicates the user, whose attributes are
   loaded.

   This function can be used from REQUEST_ROUTE, FAILURE_ROUTE.

   Example 1.8. radius_load_callee_avps() usage
...
radius_load_callee_avps("$rU@$rd");     # take callee from Request-URI
...
